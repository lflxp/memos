import{b as A,u as F,d as B,i as E,r,j as e,k as L,I as _,B as c,l as q,L as D,A as R,m as T,s as G,n as d,o as H,p as O}from"./index-d6fbc60c.js";const W=()=>{const a=A(),u=F(),h=B(),n=E(!1),{appearance:v,locale:N,systemStatus:t}=u.state,g=t.profile.mode,[i,x]=r.useState(""),[l,p]=r.useState(""),w=t.disablePasswordLogin,[j,b]=r.useState([]);r.useEffect(()=>{(async()=>{const{data:o}=await T();b(o)})()},[]),r.useEffect(()=>{g==="demo"&&(x("demohero"),p("secret"))},[g]);const C=s=>{const o=s.target.value;x(o)},S=s=>{const o=s.target.value;p(o)},I=s=>{u.setLocale(s)},k=s=>{u.setAppearance(s)},U=s=>{s.preventDefault(),t!=null&&t.host?y():m()},y=async()=>{if(!(i===""||l==="")&&!n.isLoading){try{n.setLoading(),await G(i,l),await h.doSignIn()?window.location.href="/":d.error(a("message.login-failed"))}catch(s){console.error(s),d.error(s.response.data.message||a("message.login-failed"))}n.setFinish()}},m=async()=>{if(!(i===""||l==="")&&!n.isLoading){try{n.setLoading(),await H(i,l),await h.doSignIn()?window.location.href="/":d.error(a("message.signup-failed"))}catch(s){console.error(s),d.error(s.response.data.message||s.message||a("message.signup-failed"))}n.setFinish()}},P=async s=>{const o=`auth.signin.${s.name}-${s.id}`;if(s.type==="OAUTH2"){const $=O("/auth/callback"),f=s.config.oauth2Config,z=`${f.authUrl}?client_id=${f.clientId}&redirect_uri=${$}&state=${o}&response_type=code&scope=${encodeURIComponent(f.scopes.join(" "))}`;window.location.href=z}};return e.jsx("div",{className:"flex flex-row justify-center items-center w-full h-full dark:bg-zinc-800",children:e.jsxs("div",{className:"w-80 max-w-full h-full py-4 flex flex-col justify-start items-center",children:[e.jsxs("div",{className:"w-full py-4 grow flex flex-col justify-center items-center",children:[e.jsxs("div",{className:"w-full flex flex-col justify-center items-center mb-2",children:[e.jsx("img",{className:"h-20 w-auto rounded-full shadow mr-1",src:t.customizedProfile.logoUrl,alt:""}),e.jsx("p",{className:"text-3xl text-black opacity-80 dark:text-gray-200",children:t.customizedProfile.name})]}),!w&&e.jsxs("form",{className:"w-full mt-4",onSubmit:U,children:[e.jsxs("div",{className:"flex flex-col justify-start items-start w-full gap-4",children:[e.jsx(L,{className:"w-full",size:"lg",type:"text",placeholder:a("common.username"),value:i,onChange:C,required:!0}),e.jsx(L,{className:"w-full",size:"lg",type:"password",placeholder:a("common.password"),value:l,onChange:S,required:!0})]}),e.jsxs("div",{className:"flex flex-row justify-end items-center w-full mt-6",children:[n.isLoading&&e.jsx(_.Loader,{className:"w-4 h-auto mr-2 animate-spin dark:text-gray-300"}),t.host?e.jsxs(e.Fragment,{children:[(t==null?void 0:t.allowSignUp)&&e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"plain",disabled:n.isLoading,onClick:m,children:a("common.sign-up")}),e.jsx("span",{className:"mr-2 font-mono text-gray-200",children:"/"})]}),e.jsx(c,{type:"submit",disabled:n.isLoading,onClick:y,children:a("common.sign-in")})]}):e.jsx(c,{disabled:n.isLoading,onClick:m,children:a("common.sign-up")})]})]}),!t.host&&e.jsx("p",{className:"w-full inline-block float-right text-sm mt-4 text-gray-500 text-right whitespace-pre-wrap",children:a("auth.host-tip")}),j.length>0&&e.jsxs(e.Fragment,{children:[!w&&e.jsx(q,{className:"!my-4",children:a("common.or")}),e.jsx("div",{className:"w-full flex flex-col space-y-2",children:j.map(s=>e.jsx(c,{variant:"outlined",color:"neutral",className:"w-full",size:"md",onClick:()=>P(s),children:a("common.sign-in-with",{provider:s.name})},s.id))})]})]}),e.jsxs("div",{className:"flex flex-row items-center justify-center w-full gap-2",children:[e.jsx(D,{value:N,onChange:I}),e.jsx(R,{value:v,onChange:k})]})]})})};export{W as default};
